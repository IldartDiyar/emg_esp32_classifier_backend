@startuml
title TRAINING MODE â€“ ESP32 + Backend + Frontend

actor Frontend
participant Backend
participant ESP32

Frontend -> Backend: event=start_training (movement_id)
Backend -> ESP32: event=start_training (movement_id)
Backend -> Frontend: training_status (start)

loop repetitions (1..5)
    ESP32 -> Backend: training_repetition_started
    Backend -> Backend: create new RAW buffer

    loop every 100ms (5s)
        ESP32 -> Backend: raw_stream (raw[], timestamp)
        Backend -> Backend: append to current repetition buffer
    end

    ESP32 -> Backend: training_repetition_finished\n(duration_ms, samples_collected)
    Backend -> Backend: save RAW + features to DB
    Backend -> Frontend: training_status (repetition progress)
end

ESP32 -> Backend: training_completed
Backend -> Frontend: training_completed

@enduml
